{
   "title": "Sapphire Plug-ins for AVX2: MathOps",
   "date": "2022-11-17T00:00:00",
   "thumbnail_url": "//cdn.borisfx.com/documentation/sapphire/MathOps.jpg"
}
 <font size="1">
 </font>
 <table border="0" cellpadding="0" cellspacing="0" width="100%">
  <tr>
   <td valign="top">
    <a name="MathOps">
     <h2>
      S_MathOps
     </h2>
    </a>
    Combines two clips using one of a variety of mathematical operations.  The
  colors of each input can also be adjusted using the lights, darks, and
  saturation parameters.
    <p>
     In the Sapphire Composite category.
    </p>
    <p>
     <br/>
    </p>
    <h3>
     Inputs:
    </h3>
    <dl>
     <dd>
      <b>
       SourceA:
      </b>
      <i>
       The current track.
      </i>
      The first input clip to be processed.
     </dd>
    </dl>
    <p>
    </p>
    <dl>
     <dd>
      <b>
       SourceB:
      </b>
      <i>
       Selectable.
      </i>
      The second input clip to be processed.
     </dd>
    </dl>
    <p>
    </p>
    <dl>
     <dd>
      <b>
       Background:
      </b>
      <i>
       Optional.
      </i>
      The clip to use as background.  The output of the effect is composited over this clip.
     </dd>
    </dl>
    <p>
    </p>
    <dl>
     <dd>
      <b>
       Mask:
      </b>
      <i>
       Optional.
      </i>
      Interpolate between the result and the Source input.  White areas
use the result of the effect.  Black areas use the Source clip.
     </dd>
    </dl>
   </td>
   <td>
   </td>
   <td align="right" valign="top" width="244">
    <table border="0" cellpadding="2" cellspacing="0">
     <tr>
      <td bgcolor="#303030" height="162" valign="center" width="240">
       <img align="center" alt="" height="162" src="//cdn.borisfx.com/documentation/sapphire/MathOps.jpg" valign="bottom" width="240"/>
      </td>
     </tr>
    </table>
   </td>
  </tr>
 </table>
 <p>
 </p>
 <h3>
  Parameters:
 </h3>
 <p>
 </p>
 <dl>
  <dd>
   <b>
    Load Preset:
   </b>
   <i>
    Push-button
   </i>
   .
   <br/>
   Brings up the Preset Browser to browse all available presets for this effect.
  </dd>
 </dl>
 <p>
 </p>
 <dl>
  <dd>
   <b>
    Save Preset:
   </b>
   <i>
    Push-button
   </i>
   .
   <br/>
   Brings up the Preset Save dialog to save a preset for this effect.
  </dd>
 </dl>
 <p>
 </p>
 <dl>
  <dd>
   <b>
    Operation:
   </b>
   <i>
    Popup menu,  Default: Add
   </i>
   .
   <br/>
   Determines which mathematical operation is applied to
combine the pixel colors of the two source inputs.
   <br/>
   <dl>
    <dd>
     <b>
      <i>
       Add:
      </i>
     </b>
     A + B.
     <br/>
     <dd>
      <b>
       <i>
        Subtract:
       </i>
      </b>
      A - B.
      <br/>
      <dd>
       <b>
        <i>
         Multiply:
        </i>
       </b>
       A * B.  This can be used as an 'intersection'
  operation on matte images.  The result only contains white where both
  inputs are white.
       <br/>
       <dd>
        <b>
         <i>
          Divide:
         </i>
        </b>
        A / B.  This can be used to 'un-premultiply' an
  image by using its matte as the second input.
        <br/>
        <dd>
         <b>
          <i>
           Screen:
          </i>
         </b>
         A + B - AB.  This can be useful in combining the
  bright areas of two clips.  It can also be used as a 'union'
  operation on matte images.  The result is white where either of the
  input images is white.
         <br/>
         <dd>
          <b>
           <i>
            Average:
           </i>
          </b>
          (A + B) / 2.
          <br/>
          <dd>
           <b>
            <i>
             Overlay:
            </i>
           </b>
           combines A over B with an overlay function.
           <br/>
           <dd>
            <b>
             <i>
              Minimum:
             </i>
            </b>
            the smallest value for each color channel of each
  pixel.  This can also be used as an 'intersection' operation with
  slightly different results than Multiply.
            <br/>
            <dd>
             <b>
              <i>
               Maximum:
              </i>
             </b>
             the largest value for each color channel of each
  pixel.  This can also be used as a 'union' operation with slightly
  different results than Screen.
             <br/>
             <dd>
              <b>
               <i>
                Difference:
               </i>
              </b>
              similar to Subtract but the absolute value of
  the result is used, which tends to give more resulting colors in
  bounds.  This can be used to select the regions of two matte
  images where one or the other is white, but not both.
              <br/>
              <dd>
               <b>
                <i>
                 Xor:
                </i>
               </b>
               performs an 'exclusive-or' operation on the colors of
  the source clips.  This can also be used to select the regions of two
  matte images where one or the other is white, but not both, with
  slightly different results than Difference.
               <br/>
               <dd>
                <b>
                 <i>
                  Xor Bits:
                 </i>
                </b>
                performs a bitwise exclusive-or on the colors of
  the source clips.  This can produce some interesting contour effects
  although the results are often difficult to predict.
                <br/>
                <dd>
                 <b>
                  <i>
                   And Bits:
                  </i>
                 </b>
                 performs a bitwise logical and on the colors of
  the source clips.  Similar to XorBits but tends to produce darker
  results.
                 <br/>
                 <dd>
                  <b>
                   <i>
                    Or Bits:
                   </i>
                  </b>
                  performs a bitwise logical or on the colors of
  the source clips.  Similar to XorBits but tends to produce brighter
  results.
                  <br/>
                  <dd>
                   <b>
                    <i>
                     Mod:
                    </i>
                   </b>
                   gives the remainder after dividing the colors of the
  first source clip by the second.  Set the A Scale parameter to a
  high value for some unusual pixel banding effects.
                   <br/>
                   <dd>
                    <b>
                     <i>
                      Round:
                     </i>
                    </b>
                    the colors of the first source clip are rounded using
  the values of the second input as the step size.
                    <br/>
                    <dd>
                     <b>
                      <i>
                       Bounce:
                      </i>
                     </b>
                     similar to Mod but the result contains fewer jagged
  edges.  Set the A Scale parameter to a high value for some striping
  effects.
                     <br/>
                    </dd>
                   </dd>
                  </dd>
                 </dd>
                </dd>
               </dd>
              </dd>
             </dd>
            </dd>
           </dd>
          </dd>
         </dd>
        </dd>
       </dd>
      </dd>
     </dd>
    </dd>
   </dl>
  </dd>
 </dl>
 <p>
 </p>
 <dl>
  <dd>
   <b>
    Mocha:
   </b>
   <i>
    Default:
   </i>
   0,
   <i>
    Range:
   </i>
   0 or greater.
   <br/>
   Brings up the Mocha window for tracking footage and
  generating masks.
  </dd>
 </dl>
 <p>
 </p>
 <dl>
  <dd>
   <b>
    Blur Mocha:
   </b>
   <i>
    Default:
   </i>
   0,
   <i>
    Range:
   </i>
   0 or greater.
   <br/>
   Blurs the Mocha Mask by this amount before using.
  This can be used to soften the edges or quantization artifacts of
  the mask, and smooth out the time displacements.
  </dd>
 </dl>
 <p>
 </p>
 <dl>
  <dd>
   <b>
    Mocha Opacity:
   </b>
   <i>
    Default:
   </i>
   1,
   <i>
    Range:
   </i>
   0 to 1.
   <br/>
   Controls the strength of the Mocha mask.
  Lower values reduce the intensity of the effect.
  </dd>
 </dl>
 <p>
 </p>
 <dl>
  <dd>
   <b>
    Invert Mocha:
   </b>
   <i>
    Check-box,  Default:
   </i>
   off.
   <br/>
   If enabled, the black and white of the Mocha Mask
  are inverted before applying the effect.
  </dd>
 </dl>
 <p>
 </p>
 <dl>
  <dd>
   <b>
    Resize Mocha:
   </b>
   <i>
    Default:
   </i>
   1,
   <i>
    Range:
   </i>
   0 to 2.
   <br/>
   Scales the Mocha Mask.  1.0 is the original size.
  </dd>
 </dl>
 <p>
 </p>
 <dl>
  <dd>
   <b>
    Resize Rel X:
   </b>
   <i>
    Default:
   </i>
   1,
   <i>
    Range:
   </i>
   0 to 2.
   <br/>
   The relative horizontal size of the Mocha Mask.
  </dd>
 </dl>
 <p>
 </p>
 <dl>
  <dd>
   <b>
    Resize Rel Y:
   </b>
   <i>
    Default:
   </i>
   1,
   <i>
    Range:
   </i>
   0 to 2.
   <br/>
   The relative vertical size of the Mocha Mask.
  </dd>
 </dl>
 <p>
 </p>
 <dl>
  <dd>
   <b>
    Shift Mocha:
   </b>
   <i>
    X &amp; Y,   Default:
   </i>
   [0 0],
   <i>
    Range:
   </i>
   any.
   <br/>
   Offsets the position of the Mocha Mask.
  </dd>
 </dl>
 <p>
 </p>
 <dl>
  <dd>
   <b>
    Bypass Mocha:
   </b>
   <i>
    Check-box,  Default:
   </i>
   off.
   <br/>
   Ignore the Mocha Mask and apply the effect to the
  entire source clip.
  </dd>
 </dl>
 <p>
 </p>
 <dl>
  <dd>
   <b>
    Show Mocha Only:
   </b>
   <i>
    Check-box,  Default:
   </i>
   off.
   <br/>
   Bypass the effect and show the Mocha Mask itself.
  </dd>
 </dl>
 <p>
 </p>
 <dl>
  <dd>
   <b>
    Combine Masks:
   </b>
   <i>
    Popup menu,  Default: Union
   </i>
   .
   <br/>
   Determines how to combine the Mocha Mask and Input
  Mask when both are supplied to the effect.
   <br/>
   <dl>
    <dd>
     <b>
      <i>
       Union:
      </i>
     </b>
     Uses the area covered by both masks together.
     <br/>
     <dd>
      <b>
       <i>
        Intersect:
       </i>
      </b>
      Uses the area that overlaps between the two masks.
      <br/>
      <dd>
       <b>
        <i>
         Mocha Only:
        </i>
       </b>
       Ignore the Input Mask and only use the
  Mocha Mask.
       <br/>
      </dd>
     </dd>
    </dd>
   </dl>
  </dd>
 </dl>
 <p>
 </p>
 <dl>
  <dd>
   <b>
    A Scale Lights:
   </b>
   <i>
    Default:
   </i>
   1,
   <i>
    Range:
   </i>
   0 or greater.
   <br/>
   Scales the brightness of SourceA before performing the operation.
  </dd>
 </dl>
 <p>
 </p>
 <dl>
  <dd>
   <b>
    A Offset Darks:
   </b>
   <i>
    Default:
   </i>
   0,
   <i>
    Range:
   </i>
   any.
   <br/>
   Offsets the darker regions of the first input before
  performing the effect.  This can be negative to increase contrast.
  </dd>
 </dl>
 <p>
 </p>
 <dl>
  <dd>
   <b>
    A Saturation:
   </b>
   <i>
    Default:
   </i>
   1,
   <i>
    Range:
   </i>
   0 or greater.
   <br/>
   Adjusts the color intensity of SourceA before
  performing the operation.  0.0 makes it monochromatic, 1.0 has no effect.
  </dd>
 </dl>
 <p>
 </p>
 <dl>
  <dd>
   <b>
    B Scale Lights:
   </b>
   <i>
    Default:
   </i>
   1,
   <i>
    Range:
   </i>
   0 or greater.
   <br/>
   Scales the brightness of SourceB before performing the operation.
  </dd>
 </dl>
 <p>
 </p>
 <dl>
  <dd>
   <b>
    B Offset Darks:
   </b>
   <i>
    Default:
   </i>
   0,
   <i>
    Range:
   </i>
   any.
   <br/>
   Offsets the darker regions of the second input before
  performing the effect.  This can be negative to increase contrast.
  </dd>
 </dl>
 <p>
 </p>
 <dl>
  <dd>
   <b>
    B Saturation:
   </b>
   <i>
    Default:
   </i>
   1,
   <i>
    Range:
   </i>
   0 or greater.
   <br/>
   Adjusts the color intensity of SourceB before
  performing the operation.  0.0 makes it monochromatic, 1.0 has no effect.
  </dd>
 </dl>
 <p>
 </p>
 <dl>
  <dd>
   <b>
    Dest Scale Lights:
   </b>
   <i>
    Default:
   </i>
   1,
   <i>
    Range:
   </i>
   0 or greater.
   <br/>
   Scales the brightness of the result after performing the operation.
  </dd>
 </dl>
 <p>
 </p>
 <dl>
  <dd>
   <b>
    Dest Offset Darks:
   </b>
   <i>
    Default:
   </i>
   0,
   <i>
    Range:
   </i>
   any.
   <br/>
   Offsets the darker regions of the result after
  performing the effect.  This can be negative to increase contrast.
  </dd>
 </dl>
 <p>
 </p>
 <dl>
  <dd>
   <b>
    Dest Saturation:
   </b>
   <i>
    Default:
   </i>
   1,
   <i>
    Range:
   </i>
   0 or greater.
   <br/>
   Scales the color intensity of the result after
  performing the operation.  0.0 makes it monochromatic, 1.0 has no effect.
  </dd>
 </dl>
 <p>
 </p>
 <dl>
  <dd>
   <b>
    Swap Inputs:
   </b>
   <i>
    Check-box,  Default:
   </i>
   off.
   <br/>
   If enabled, effectively swaps the A and B Source inputs,
  and can be helpful for non-commutative operations like subtract.
  Note that this also causes parameters labeled 'A' to affect the
  'B' input instead, and vice versa.
  </dd>
 </dl>
 <p>
 </p>
 <dl>
  <dd>
   <b>
    Mask Use:
   </b>
   <i>
    Popup menu,  Default: Luma
   </i>
   .
   <br/>
   Determines how the Mask input channels are used to make a
monochrome mask.
   <br/>
   <dl>
    <dd>
     <b>
      <i>
       Luma:
      </i>
     </b>
     the luminance of the RGB channels is used.
     <br/>
     <dd>
      <b>
       <i>
        Alpha:
       </i>
      </b>
      only the Alpha channel is used, or if there is no
valid Alpha channel the Red channel is used.
      <br/>
     </dd>
    </dd>
   </dl>
  </dd>
 </dl>
 <p>
 </p>
 <dl>
  <dd>
   <b>
    Blur Mask:
   </b>
   <i>
    Default:
   </i>
   0.05,
   <i>
    Range:
   </i>
   0 or greater.
   <br/>
   Blurs the Mask input by this amount before using.  This
can provide a smoother transition between the masked and unmasked
areas.  It has no effect unless the Mask input is provided.
  </dd>
 </dl>
 <p>
 </p>
 <dl>
  <dd>
   <b>
    Invert Mask:
   </b>
   <i>
    Check-box,  Default:
   </i>
   off.
   <br/>
   If on, inverts the mask input so the effect is applied
to areas where the Mask is black instead of white.  This has no effect
unless the Mask input is provided.
  </dd>
 </dl>
 See general info for:
 <a href="../general-info#title-key">
  Apply To Title/Key
 </a>
 ,
 <a href="../general-info#transform">
  Crop/Transform
 </a>
 ,
 <a href="../general-info#other-params">
  Resolution
 </a>
 ,
 <a href="../general-info#other-params">
  Clamp Output To Legal
 </a>
 ,
 <a href="../general-info#other-params">
  Bypass Effect
 </a>
 , and
 <a href="../general-info#reset-defaults">
  Reset
 </a>
 .
 <p>
  <br/>
 </p>
 <h3>
  See Also:
 </h3>
 <dl>
  <dd>
   <table border="0" cellpadding="0" cellspacing="0">
    <tr>
     <td valign="top">
     </td>
     <td valign="top">
     </td>
     <td valign="top">
      <a href="../layer">
       Layer
      </a>
      <br/>
      <a href="../intro">
       Sapphire Plug-ins Introduction
      </a>
     </td>
    </tr>
   </table>
  </dd>
 </dl>
